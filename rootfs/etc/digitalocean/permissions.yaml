permissions:
  # =============================================================================
  # Read-only system directories
  # =============================================================================
  - path: /docs
    user: root
    group: root
    mode: "0555"
  - path: /docs/*
    user: root
    group: root
    mode: "0444"

  - path: /etc/s6-overlay/lib
    user: root
    group: root
    mode: "0555"
  - path: /etc/s6-overlay/lib/*
    user: root
    group: root
    mode: "0444"

  - path: /etc/digitalocean
    user: root
    group: root
    mode: "0555"
  - path: /etc/digitalocean/*
    user: root
    group: root
    mode: "0444"

  # =============================================================================
  # s6 container environment
  # =============================================================================
  - path: /run/s6/container_environment
    user: root
    group: root
    mode: "0755"

  # Default: root only
  - path: /run/s6/container_environment/**/*
    user: root
    group: root
    mode: "0600"

  # PUBLIC_: world-readable, broadcast to all prefixes
  - path: /run/s6/container_environment/PUBLIC_
    user: root
    group: root
    mode: "0755"
  - path: /run/s6/container_environment/PUBLIC_/*
    user: root
    group: root
    mode: "0644"

  # OPENCLAW_: openclaw only
  - path: /run/s6/container_environment/OPENCLAW_
    user: openclaw
    group: openclaw
    mode: "0750"
  - path: /run/s6/container_environment/OPENCLAW_/*
    user: openclaw
    group: openclaw
    mode: "0640"

  # SSH_: root only
  - path: /run/s6/container_environment/SSH_
    user: root
    group: root
    mode: "0750"
  - path: /run/s6/container_environment/SSH_/*
    user: root
    group: root
    mode: "0640"

  # TS_: root only (sensitive)
  - path: /run/s6/container_environment/TS_
    user: root
    group: root
    mode: "0750"
  - path: /run/s6/container_environment/TS_/*
    user: root
    group: root
    mode: "0640"

  # OpenClaw state directory
  - path: /data/.openclaw
    user: openclaw
    group: openclaw
    mode: "0700"
  - path: /data/.openclaw/**
    user: openclaw
    group: openclaw
  - path: /data/.openclaw/openclaw.json
    user: openclaw
    group: openclaw
    mode: "0600"

  # Tailscale state directory
  - path: /data/tailscale
    user: openclaw
    group: openclaw
    mode: "0750"

  # Cron directories and files
  - path: /etc/cron.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/cron.d/*
    user: root
    group: root
    mode: "0644"

  # s6-overlay directories and scripts
  - path: /etc/cont-init.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/cont-init.d/*
    user: root
    group: root
    mode: "0755"
  - path: /etc/services.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/cont-finish.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/cont-finish.d/*
    user: root
    group: root
    mode: "0755"
  - path: /etc/services.d
    user: root
    group: root
    mode: "0755"

  # =============================================================================
  # Cron
  # =============================================================================
  - path: /etc/cron.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/cron.d/*
    user: root
    group: root
    mode: "0644"

  # =============================================================================
  # SSH
  # =============================================================================
  # sshd requires /etc to have strict ownership for authorized_keys to work
  - path: /etc
    user: root
    group: root
    mode: "0755"

  - path: /etc/ssh
    user: root
    group: root
    mode: "0755"
  - path: /etc/ssh/sshd_config.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/ssh/sshd_config.d/*
    user: root
    group: root
    mode: "0644"
  - path: /etc/ssh/ssh_config.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/ssh/ssh_config.d/*
    user: root
    group: root
    mode: "0644"
  - path: /etc/ssh/authorized_keys
    user: root
    group: root
    mode: "0644"

  # All .ssh directories and keys (ownership inherited from parent)
  - path: /**/.ssh
    mode: "0700"
  - path: /**/.ssh/authorized_keys
    mode: "0600"
  - path: /**/.ssh/id_*
    mode: "0600"
  - path: /**/.ssh/*.pem
    mode: "0600"
  - path: /**/.ssh/*.key
    mode: "0600"
  - path: /**/.ssh/*.pub
    mode: "0644"

  # =============================================================================
  # Sudoers
  # =============================================================================
  - path: /etc/sudoers.d
    user: root
    group: root
    mode: "0750"
  - path: /etc/sudoers.d/*
    user: root
    group: root
    mode: "0440"

  # =============================================================================
  # Profile scripts
  # =============================================================================
  - path: /etc/profile.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/profile.d/*
    user: root
    group: root
    mode: "0644"

  # =============================================================================
  # MOTD
  # =============================================================================
  - path: /etc/update-motd.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/update-motd.d/*
    user: root
    group: root
    mode: "0755"
  - path: /usr/local/bin/motd
    user: root
    group: root
    mode: "0755"

  # =============================================================================
  # Application data
  # =============================================================================
  - path: /data/.openclaw
    user: openclaw
    group: openclaw
    mode: "0700"
  - path: /data/.openclaw/**
    user: openclaw
    group: openclaw
  - path: /data/.openclaw/openclaw.json
    user: openclaw
    group: openclaw
    mode: "0600"

  # =============================================================================
  # Scripts
  # =============================================================================
  - path: /usr/local/bin/ssh-rotate-local-key
    user: root
    group: root
    mode: "0755"
